pipeline {
  agent any

  tools {nodejs "nodejs"}
    
  stages {
    stage('Build') {
      environment {
          ENV_PATH = credentials('session-2-env-test')
          WORKING_DIR='/home/mukherjeeabhilash8/chat-application/backend'
      }
      steps {
          dir("$WORKING_DIR") {
            sh """
                cat $ENV_PATH > ".env"
            """
            sh "npm install"
            
          }
        }
      
    }  
    // stage('DEPLOY TO GCP') {
    //   steps {
    //     sshagent(credentials: ['ssh-key']) {
    //         sh "ssh -o StrictHostKeyChecking=no -l mukherjeeabhilash8 34.28.167.217"
    //     }
    //   }
    // }
    // stage('Pass secret as command line parameter') {
    //   steps {
    //     echo "Hello ${env.NODE_ENV}"
    //   }
    // }
  }
}